(function(a){return a.fn.canvasResizer=function(e){var f,d,c,b;c={width:640,height:480,success:function(g){return g}};b=a.extend(c,e);d=function(h){var g,i=this;g=this.files;if(g.length){this.image=new Image;this.image.onload=function(){return f.call(i)};return this.image.src=URL.createObjectURL(g[0])}};f=function(){var g,r,j,n,i,s,k,o,l,p,q,m=this;i=document.createElement("canvas");k=this.image.height;q=this.image.width;if(q>b.width||k>b.height){j=q/b.width;g=k/b.height;n=k/j;r=q/g;if(n<=b.height&&r<=b.width){o=g>=j?j:g}else{if(n<=b.height){o=j}else{o=g}}p=Math.floor(q/o);l=Math.floor(k/o)}else{p=q;l=k}i.setAttribute("width",p);i.setAttribute("height",l);s=i.getContext("2d");s.drawImage(this.image,0,0,p,l);this.image.onload=function(){return b.success.call(m,m.image)};return this.image.src=i.toDataURL()};return this.each(function(){if(this.nodeName!=="INPUT"||this.attributes.getNamedItem("type").value.toLowerCase()!=="file"){return false}return a(this).on("change",d)})}})(jQuery);